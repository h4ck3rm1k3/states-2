#!/usr/bin/env python
import os
import shutil
import sys

BASE = '/etc/salt/pillars'
HOSTS_DIR = 'hosts'
RFQDN = '/'.join(reversed(sys.argv[1].split('.')))
DIRS = [
    'common',
    os.path.join(HOSTS_DIR, RFQDN)
]

for d in DIRS:
    d = os.path.join(BASE, d)
    if not os.path.isdir(d):
        continue

    for fn in sorted(os.listdir(d)):
        with open(os.path.join(d, fn)) as fh:
            shutil.copyfileobj(fh, sys.stdout)
        sys.stdout.write("\n")
